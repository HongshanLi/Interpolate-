<div class="main">
  <div class="sidenav">
    <button mat-button matToolTip="add documents from My Library"
    [matMenuTriggerFor]="myDocs" (click)="showDocsInMyLib()"
    color="primary">
      Add documents
    </button>

    <mat-menu #myDocs="matMenu">
      <button mat-menu-item *ngFor="let lit of docsInMyLib"
      (click)="addLitToGroup(lit)">
        {{ lit.title }}
      </button>
    </mat-menu>

  </div>

  <div class="content">
    <mat-form-field>
      <input matInput (keydown.enter)="search($event)" placeholder="Search a file">
    </mat-form-field>
  </div>
</div>

    <!-- end of form for uploading paper -->

  <div>
    <div *ngFor="let lit of lits">
      <mat-card>
        <h4> {{ lit.title }}</h4>
        <p> {{ lit.authors }}</p>
        <h5 class="text text-info">Uploaded by {{ lit.userName }} at
          {{ timestampToDate(lit.uploadTime) }} </h5>
        <hr>
        <div>
          <button id="open" class="btn btn-success" (click)="openLit(lit)">OPEN</button>
          <button id="edit" class="btn btn-primary" (click)="onUpdate(lit)">EDIT</button>
          <button id="delete" class="btn btn-danger float-right" *ngIf="lit.threadsCount===0"
          (click)="onDelete(lit._id)">DELETE</button>
        </div>
      </mat-card>
      <br>
      <!--update form -->
      <mat-card *ngIf="litToUpdateId==lit._id">
        <mat-spinner *ngIf="isLoading"></mat-spinner>
          <form [formGroup]="updateForm" (submit)="onSaveUpdates(lit)" >
            <mat-form-field id="field">
              <input matInput type="text" formControlName="title"
                placeholder="Title of the literature">
              <mat-error *ngIf="updateForm.get('title').invalid">
              Please enter the title of the paper/note you want to upload.
              </mat-error>
            </mat-form-field>
            <mat-form-field id="field">
              <input matInput type="text" formControlName="authors"
                placeholder="Authors of the literature separated by comma">
                <mat-error *ngIf="updateForm.get('authors').invalid">Please enter the name(s) of the author(s)
                </mat-error>
              </mat-form-field>
          <button class="btn btn-success" color="primary" type="submit">Save Updates</button>
        </form>
      </mat-card>
    </div>
  </div>

  <div *ngIf="showMatchedFiles">
    <h4 *ngIf="matchedFiles.length==0" class="text text-info">
      No files matched your search
    </h4>
    <div *ngFor="let lit of matchedFiles">
      <mat-card>
        <h4> {{ lit.title }}</h4>
        <p> {{ lit.authors }}</p>
        <h5 class="text text-info">Uploaded by {{ lit.userName }} at
          {{ timestampToDate(lit.uploadTime) }} </h5>
        <hr>
        <div>
          <button id="open" class="btn btn-success" (click)="openLit(lit._id)">OPEN</button>
          <button id="edit" class="btn btn-primary" (click)="onUpdate(lit)">EDIT</button>
          <button id="delete" class="btn btn-danger float-right" *ngIf="lit.threadsCount===0"
          (click)="onDelete(lit._id)">DELETE</button>
        </div>
      </mat-card>
      <br>
      <!--update form -->
      <mat-card *ngIf="litToUpdateId==lit._id">
        <mat-spinner *ngIf="isLoading"></mat-spinner>
          <form [formGroup]="updateForm" (submit)="onSaveUpdates(lit)" >
            <mat-form-field id="field">
              <input matInput type="text" formControlName="title"
                placeholder="Title of the literature">
              <mat-error *ngIf="updateForm.get('title').invalid">
              Please enter the title of the paper/note you want to upload.
              </mat-error>
            </mat-form-field>
            <mat-form-field id="field">
              <input matInput type="text" formControlName="authors"
                placeholder="Authors of the literature separated by comma">
                <mat-error *ngIf="updateForm.get('authors').invalid">Please enter the name(s) of the author(s)
                </mat-error>
              </mat-form-field>
          <button class="btn btn-success" color="primary" type="submit">Save Updates</button>
        </form>
      </mat-card>
    </div>
  </div>
